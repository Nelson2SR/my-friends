{"version":3,"sources":["webpack:////Users/surong/Project/HBuilderProject/MyFriends/main.js","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/profile/profile.vue?a7eb","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/profile/profile.vue?bbe9","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/profile/profile.vue?2951","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/profile/profile.vue?7243","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/profile/profile.vue"],"names":["createPage","Page","data","avatar","provider","computed","methods","login_weixin","console","log","self","wx","login","success","res","JSON","stringify","code","uniCloud","callFunction","name","appId","appSecret","then","openId","result","open_id","uni","setStorage","session_id","user","getUser","getUserInfo","infoRes","userInfo","toMain","fail","showToast","icon","position","title","errMsg","forcedLogin","reLaunch","url","navigateBack","length","createUser","userName","gender","id","onLoad","owner","myGroups"],"mappings":"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","file":"pages/profile/profile.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'\nimport Page from './pages/profile/profile.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./profile.vue?vue&type=template&id=f9149e1e&\"\nvar renderjs\nimport script from \"./profile.vue?vue&type=script&lang=js&\"\nexport * from \"./profile.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Users/surong/Project/HBuilderProject/MyFriends/pages/profile/profile.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./profile.vue?vue&type=template&id=f9149e1e&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./profile.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./profile.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n\tmapState,\n\tmapMutations,\n\tmapActions\n} from 'vuex'\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tavatar: [\n\t\t\t\t'https://ossweb-img.qq.com/images/lol/web201310/skin/big10001.jpg'\n\t\t\t],\n\t\t\tprovider: ''\n\t\t}\n\t},\n\tcomputed: mapState(['forcedLogin', 'hasLogin', 'userName', 'avatarUrl', 'gender']),\n\tmethods: {\n\t\t...mapActions(['login']),\n\t\tlogin_weixin() {\n\t\t\t//微信登录\n\t\t\tconsole.log('login as wechat')\n\t\t\tlet self = this;\n\t\t\twx.login({\n\t\t\t\tsuccess(res) {\n\t\t\t\t\tconsole.log('login response: %s', JSON.stringify(res))\n\t\t\t\t\tif (res.code) { //发起网络请求 \n\t\t\t\t\t\tuniCloud.callFunction({\n\t\t\t\t\t\t\tname:'oauth-login',\n\t\t\t\t\t\t\tdata:{\n\t\t\t\t\t\t\t\tcode: res.code,\n\t\t\t\t\t\t\t\tappId: 'wx95bd5dc2182e3ad4',\n\t\t\t\t\t\t\t\tappSecret: 'f51b12f21d601c68fb1fbc3bb1aea1ac'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\t\tconsole.log('OAuth Response: %s', JSON.stringify(res))\n\t\t\t\t\t\t\tconst openId = res.result.open_id\n\t\t\t\t\t\t\tuni.setStorage({\n\t\t\t\t\t\t\t\t\"sessionId\": res.result.session_id,\n\t\t\t\t\t\t\t\t\"openId\": res.result.open_id\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst user = self.getUser(openId);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tuni.getUserInfo({\n\t\t\t\t\t\t\t\tprovider: 'weixin',\n\t\t\t\t\t\t\t\tsuccess(infoRes) {\n\t\t\t\t\t\t\t\t\tconsole.log('User Info: %s', JSON.stringify(infoRes));\n\t\t\t\t\t\t\t\t\tinfoRes.userInfo.open_id = openId\n\t\t\t\t\t\t\t\t\tself.toMain(infoRes.userInfo);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfail() {\n\t\t\t\t\t\t\t\t\tuni.showToast({\n\t\t\t\t\t\t\t\t\t\ticon: 'none',\n\t\t\t\t\t\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\t\t\t\t\t\ttitle: '登陆失败'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('登录失败！' + res.errMsg)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\ttoMain(userInfo) {\n\t\t\tthis.login(userInfo);\n\t\t\t/**\n\t\t\t * 强制登录时使用reLaunch方式跳转过来\n\t\t\t * 返回首页也使用reLaunch方式\n\t\t\t */\n\t\t\tif (this.forcedLogin) {\n\t\t\t\tuni.reLaunch({\n\t\t\t\t\turl: '/pages/tabBar/home/home',\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tuni.navigateBack();\n\t\t\t}\n\t\t},\n\t\tgetUser( openId ) {\n\t\t\tlet self = this;\n\t\t\tconsole.log('Check if user registered');\n\t\t\tuniCloud.callFunction({\n\t\t\t\tname:\"user-get-by-openId\",\n\t\t\t\tdata:{\n\t\t\t\t\topen_id: openId\n\t\t\t\t}\n\t\t\t}).then(res => {\n\t\t\t\tconsole.log('get user successfully: %s', JSON.stringify(res))\n\t\t\t\t\n\t\t\t\tif ( res.result.data.length === 0 ) {\n\t\t\t\t\tconsole.log('User not found')\n\t\t\t\t\tconst user = self.createUser( openId )\n\t\t\t\t\t\n\t\t\t\t\treturn user;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconsole.log('User is retrieved: %s', JSON.stringify(res.result.data[0]))\n\t\t\t\t\treturn res.result.data[0]\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tcreateUser( openId ) {\n\t\t\tlet user = {};\n\t\t\tuser.name = this.userName;\n\t\t\tuser.provider = this.provider;\n\t\t\tuser.gender = this.gender;\n\t\t\tuser.open_id = openId;\n\n\t\t\tuniCloud.callFunction({\n\t\t\t\tname: \"user-create\",\n\t\t\t\tdata: user\n\t\t\t}).then(res => {\n\t\t\t\tconsole.log('create user successully: %s', JSON.stringify(res))\n\t\t\t\treturn res.result.id\n\t\t\t})\n\t\t}\n\t},\n\tonLoad() {\n\t\tconst owner = 'userId';\n\t\tuniCloud.callFunction({\n\t\t\t\tname: 'group-get-by-ownerId',\n\t\t\t\tdata: {\n\t\t\t\t\towner: owner\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(res => {\n\t\t\t\tthis.myGroups = res.result.data;\n\t\t\t});\n\t}\n}\n"],"sourceRoot":""}
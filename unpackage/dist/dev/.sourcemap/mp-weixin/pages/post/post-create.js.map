{"version":3,"sources":["webpack:////Users/surong/Project/HBuilderProject/MyFriends/main.js","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/post/post-create.vue?634b","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/post/post-create.vue?407c","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/post/post-create.vue?d1a8","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/post/post-create.vue?af98","webpack:////Users/surong/Project/HBuilderProject/MyFriends/pages/post/post-create.vue"],"names":["createPage","Page","data","textareaValue","groupId","groupName","imgList","components","cuUploadFile","computed","methods","inputTextArea","e","detail","value","console","log","uploadImgAndCreatePost","imgUrls","owner","name","userName","openId","gender","avatarUrl","content","likeCount","JSON","stringify","successUploadCount","failUploadCount","totalCount","length","createPost","self","forEach","img","uniCloud","uploadFile","filePath","onUploadProgress","progressEvent","percentCompleted","Math","round","loaded","total","success","res","fileID","push","fail","err","error","complete","callFunction","then","uni","navigateBack","delta","animationType","animationDuration","catch","showToast","title","icon","addImage","onLoad","options"],"mappings":"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","file":"pages/post/post-create.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/post/post-create.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./post-create.vue?vue&type=template&id=2ba80b9c&\"\nvar renderjs\nimport script from \"./post-create.vue?vue&type=script&lang=js&\"\nexport * from \"./post-create.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Users/surong/Project/HBuilderProject/MyFriends/pages/post/post-create.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./post-create.vue?vue&type=template&id=2ba80b9c&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./post-create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./post-create.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n\tmapState,\n\tmapMutations,\n\tmapActions\n} from 'vuex'\n\nimport cuUploadFile from '@/colorui/components/cu-upload-file.vue'\n\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\ttextareaValue: '',\n\t\t\tgroupId: '',\n\t\t\tgroupName: '',\n\t\t\timgList: []\n\t\t}\n\t},\n\tcomponents: {\n\t\tcuUploadFile\n\t},\n\tcomputed: mapState(['hasLogin', 'userName', 'avatarUrl', 'gender', 'openId']),\n\tmethods: {\n\t\tinputTextArea(e) {\n\t\t\tthis.textareaValue = e.detail.value\n\t\t\tconsole.log(\"Entered Text: %s\", this.textareaValue)\n\t\t},\n\t\tuploadImgAndCreatePost(e) {\n\t\t\tconsole.log('Start creating post for group %s', this.groupName)\n\t\t\tlet imgUrls = []\n\t\t\tconst data = {\n\t\t\t\towner: {\n\t\t\t\t\tname: this.userName,\n\t\t\t\t\topenId: this.openId,\n\t\t\t\t\tgender: this.gender,\n\t\t\t\t\tavatarUrl: this.avatarUrl\n\t\t\t\t},\n\t\t\t\tgroupId: this.groupId,\n\t\t\t\tcontent: this.textareaValue,\n\t\t\t\timgUrls: imgUrls,\n\t\t\t\tlikeCount:[]\n\t\t\t}\n\t\t\tconsole.log('Post data: %s', JSON.stringify(data))\n\n\t\t\tlet successUploadCount = 0\n\t\t\tlet failUploadCount = 0\n\t\t\tconst totalCount = this.imgList.length\n\t\t\tif (this.imgList.length === 0) {\n\t\t\t\tthis.createPost(data)\n\t\t\t} else {\n\t\t\t\tconst self = this;\n\t\t\t\tthis.imgList.forEach(img => {\n\t\t\t\t\tuniCloud.uploadFile({\n\t\t\t\t\t\tfilePath: img,\n\t\t\t\t\t\tonUploadProgress: function(progressEvent) {\n\t\t\t\t\t\t\t// console.log(progressEvent);\n\t\t\t\t\t\t\tvar percentCompleted = Math.round(\n\t\t\t\t\t\t\t\t(progressEvent.loaded * 100) / progressEvent.total\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess(res) {\n\t\t\t\t\t\t\tconsole.log(\"successfully upload img \" + res.fileID)\n\t\t\t\t\t\t\timgUrls.push(res.fileID);\n\t\t\t\t\t\t\tsuccessUploadCount += 1\n\n\t\t\t\t\t\t\t// after all images successfully uploaded, creat post\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (successUploadCount === totalCount) {\n\t\t\t\t\t\t\t\tself.createPost(data)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tfail(err) {\n\t\t\t\t\t\t\tconsole.error(err)\n\t\t\t\t\t\t\tfailUploadCount += 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomplete() {\n\t\t\t\t\t\t\tconsole.log(\"completed\")\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\tcreatePost(data) {\n\t\t\tconsole.log('Start to create post: %s', JSON.stringify(data))\n\t\t\tuniCloud.callFunction({\n\t\t\t\tname: 'post-create',\n\t\t\t\tdata: data\n\t\t\t}).then(res => {\n\t\t\t\tconsole.log('Successfully create post: %s', JSON.stringify(res))\n\t\t\t\tuni.navigateBack({\n\t\t\t\t\tdelta: 1,\n\t\t\t\t\tanimationType: 'pop-out',\n\t\t\t\t\tanimationDuration: 200\n\t\t\t\t})\n\t\t\t}).catch(err => {\n\t\t\t\tconsole.error('Error occur while creating post: %s', JSON.stringify(err))\n\t\t\t\tuni.showToast({\n\t\t\t\t\ttitle: \"创建错误\",\n\t\t\t\t\ticon: \"none\"\n\t\t\t\t})\n\t\t\t})\n\t\t},\n\t\taddImage(e) {\n\t\t\tconsole.log('Add image: %s', e)\n\t\t\tthis.imgList = e;\n\t\t}\n\n\t},\n\tonLoad(options) {\n\t\tconsole.log('Options: %s', JSON.stringify(options))\n\t\tthis.groupId = options.groupId,\n\t\t\tthis.groupName = options.groupName\n\t}\n}\n"],"sourceRoot":""}
{"version":3,"sources":["webpack:////Users/surong/Project/HBuilderProject/MyFriends/colorui/components/cu-post.vue?c382","webpack:////Users/surong/Project/HBuilderProject/MyFriends/colorui/components/cu-post.vue?56c1","webpack:////Users/surong/Project/HBuilderProject/MyFriends/colorui/components/cu-post.vue?9756","webpack:////Users/surong/Project/HBuilderProject/MyFriends/colorui/components/cu-post.vue?44c3","uni-app:///colorui/components/cu-post.vue"],"names":[],"mappings":"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","file":"colorui/components/cu-post.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./cu-post.vue?vue&type=template&id=c6ec83f0&\"\nvar renderjs\nimport script from \"./cu-post.vue?vue&type=script&lang=js&\"\nexport * from \"./cu-post.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"colorui/components/cu-post.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cu-post.vue?vue&type=template&id=c6ec83f0&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cu-post.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cu-post.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"cu-card dynamic margin-top\" :class=\"isCard?'no-card':''\">\r\n\t\t<view class=\"cu-item shadow\">\r\n\t\t\t<view class=\"cu-list menu-avatar\">\r\n\t\t\t\t<view class=\"cu-item\">\r\n\t\t\t\t\t<view class=\"cu-avatar round lg\" :style=\"{backgroundImage: `url(${item.owner.avatarUrl})`}\"></view>\r\n\t\t\t\t\t<view class=\"content flex-sub\">\r\n\t\t\t\t\t\t<view>{{ item.owner.name }}</view>\r\n\t\t\t\t\t\t<view class=\"text-gray text-sm flex justify-between\">\r\n\t\t\t\t\t\t\t{{ createdAt }}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"text-content\">\r\n\t\t\t\t{{ item.content }}\r\n\t\t\t</view>\r\n\t\t\t<view class=\"grid flex-sub padding-lr\" :class=\"imgCol\">\r\n\t\t\t\t<view class=\"bg-img\" v-for=\"img in item.imgUrls\">\r\n\t\t\t\t\t<image :src=\"img\" mode=\"aspectFill\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"text-gray text-sm text-right padding\">\r\n\t\t\t<!-- \t<text class=\"cuIcon-attentionfill margin-lr-xs\"></text> 0 -->\r\n\t\t\t\t<text class=\"cuIcon-appreciatefill margin-lr-xs\" :class=\"hasLikePost?'text-red':''\"></text> {{ postLikeCount }}\r\n\t\t\t\t<text class=\"cuIcon-messagefill margin-lr-xs\"></text> {{ comments.length }}\r\n\t\t\t</view>\r\n\n\t\t\t<view class=\"action-button\">\n\t\t\t\t<button type=\"default\" @click=\"likePost\">like</button>\n\t\t\t\t<button type=\"default\" @click=\"viewComment\">comment</button>\n\t\t\t<!-- \t<button type=\"default\">share</button> -->\n\t\t\t</view>\n\t\t\t\r\n\t\t\t<view class=\"cu-list menu-avatar comment solids-top\" v-if=\"showComment\" v-for=\"(comment, index) in comments\" :key=\"index\">\r\n\t\t\t\t<view class=\"cu-item\">\r\n\t\t\t\t\t<view class=\"cu-avatar round\" :style=\"{backgroundImage: `url(${comment.fromUser.avatarUrl})`}\"></view>\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<view class=\"text-grey\">{{comment.fromUser.name}}</view>\r\n\t\t\t\t\t\t<view class=\"text-gray text-content text-df\">\r\n\t\t\t\t\t\t\t{{comment.content}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"bg-grey padding-sm radius margin-top-sm  text-sm\" v-if=\"comment.replies.length > 0\" v-for=\"(reply, index) in comment.replies\" :key=\"index\">\r\n\t\t\t\t\t\t\t<view class=\"flex\">\r\n\t\t\t\t\t\t\t\t<view>{{reply.fromUser.name}}：{{reply.toUser.name}}</view>\r\n\t\t\t\t\t\t\t\t<view class=\"flex-sub\">{{reply.content}}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"margin-top-sm flex justify-between\">\r\n\t\t\t\t\t\t\t<view class=\"text-gray text-df\">{{comment.createdAt}}</view>\r\n\t\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-appreciatefill text-red\" @click=\"likeComment\"></text>\r\n\t\t\t\t\t\t\t\t<text class=\"cuIcon-messagefill text-gray margin-left-sm\" @click=\"sendCommentOnComment\" :id=\"comment._id\"></text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\n\t\t\t<view class=\"cu-form-group margin-top\">\n\t\t\t\t<textarea maxlength=\"-1\" @input=\"inputTextArea\" placeholder=\"写些什么...\"></textarea>\n\t\t\t\t<button type=\"default\" @click=\"sendCommentOnPost\">发送</button>\n\t\t\t</view>\n\t\t\t\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport moment from 'moment'\r\n    import {\n    \tmapState,\n    \tmapMutations,\n    \tmapActions\n    } from 'vuex'\n\t\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcreatedAt: '',\n\t\t\t\timgCol: '',\n\t\t\t\tcomments: [],\n\t\t\t\tshowComment: true,\n\t\t\t\ttextareaValue: '',\n\t\t\t\tsendOnComment: true,\n\t\t\t\tcommentId:'',\n\t\t\t\tpostLikeCount:0,\n\t\t\t\thasLikePost: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tprops: {\r\n\t\t\titem: {\r\n\t\t\t\ttype: Object,\r\n\t\t\t\tdefault: {}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\n\t\t\t...mapState(['hasLogin', 'userName', 'avatarUrl', 'gender', 'openId']),\r\n\t\t\tformatCreatedAt() {\r\n\t\t\t\tconst now = moment.now()\r\n\t\t\t\tconst createdAt = this.item.createdAt\r\n\t\t\t\tthis.createdAt = moment(this.item.createdAt).calendar({\r\n\t\t\t\t\tsameDay: '[Today at] hh:mm',\r\n\t\t\t\t\tnextDay: '[Tomorrow]',\r\n\t\t\t\t\tnextWeek: 'dddd',\r\n\t\t\t\t\tlastDay: '[Yesterday at] hh:mm',\r\n\t\t\t\t\tlastWeek: '[Last] dddd [at] hh:mm',\r\n\t\t\t\t\tsameElse: 'DD/MM/YYYY [at] hh:mm'\r\n\t\t\t\t})\r\n\t\t\t},\n\t\t\tgetImgCol() {\n\n\t\t\t\tif ( this.item.imgUrls.length === 1) {\n\t\t\t\t\tthis.imgCol = 'col-1'\n\t\t\t\t}\n\t\t\t\telse if ( this.item.imgUrls.length % 3 === 0) {\n\t\t\t\t\tthis.imgCol = 'col-3 grid-square'\n\t\t\t\t}\n\t\t\t\telse if ( this.item.imgUrls.length % 2 === 0 ) {\n\t\t\t\t\tthis.imgCol = 'col-2 grid-square'\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.imgCol = 'col-3 grid-square'\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetPostLikeCount() {\n\t\t\t\tthis.postLikeCount = this.item.likeCount.length\n\t\t\t\t// if(this.item.likeCount.contains(this.openId)){\n\t\t\t\t// \tthis.hasLikePost = true\n\t\t\t\t// }\n\t\t\t}\r\n\t\t},\n\t\tmounted() {\n\t\t\tconsole.log('post component start to being mounted')\n\t\t\tself = this\n\t\t\tuniCloud.callFunction({\n\t\t\t\tname:'comment-get-by-topic',\n\t\t\t\tdata:{\n\t\t\t\t\t'topicId': this.item._id,\n\t\t\t\t\t'topicType': 'post'\n\t\t\t\t}\n\t\t\t}).then(res => {\n\t\t\t\tconsole.log('successfully retrieved comment on post %s: %s', self.item._id, JSON.stringify(res.result.data))\n\t\t\t\tthis.comments = res.result.data\n\t\t\t}).catch(err => {\n\t\t\t\tconsole.error('Error occur while retrieving comment on post %s', self.item._id)\n\t\t\t})\n\t\t},\n\t\tmethods:{\n\t\t\tlikePost() {\n\t\t\t\tconst data = {\n\t\t\t\t\t'topicId':this.item._id,\n\t\t\t\t\t'topicType':'post',\n\t\t\t\t\t'fromUserId': this.openId\n\t\t\t\t}\n\t\t\t\tconsole.log('start liking post %s', JSON.stringify(data))\n\t\t\t    uniCloud.callFunction({\n\t\t\t    \tname:'like-update-by-topic',\n\t\t\t\t\tdata:data\n\t\t\t    }).then(res => {\n\t\t\t\t\tconsole.log('Successfully like post %s', JSON.stringify(res))\n\t\t\t\t\tthis.postLikeCount = res.result.data.likeCount.length\n\t\t\t\t\tthis.hasLikePost = true\n\t\t\t\t}).catch(err => {\n\t\t\t\t\tconsole.error(\"Error occurs while liking post\")\n\t\t\t\t})\t\t\n\t\t\t},\n\t\t\tlikeComment(){\n\t\t\t\tuniCloud.callFunction({\n\t\t\t\t\tname:'like-update-by-topic',\n\t\t\t\t\tdata:{\n\t\t\t\t\t\t'topicId':this.item._id,\n\t\t\t\t\t\t'topicType':'comment',\n\t\t\t\t\t\t'fromUserId': this.openId\n\t\t\t\t\t}\n\t\t\t\t}).then(res => {\n\t\t\t\t\tconsole.log('Successfully like comment %s', JSON.stringify(res))\n\t\t\t\t}).catch(err => {\n\t\t\t\t\tconsole.error(\"Error occurs while liking comment\")\n\t\t\t\t})\t\t\n\t\t\t},\n\t\t\tviewComment() {\n\t\t\t\tthis.showComment = true\n\t\t\t},\n\t\t\tinputTextArea(e) {\n\t\t\t\tthis.textareaValue = e.detail.value\n\t\t\t},\n\t\t\tsendCommentOnPost() {\n\t\t\t\tif ( this.textareaValue !== '' ) {\n\t\t\t\t\tif ( !this.sendOnComment ) {\n\t\t\t\t\t\tuniCloud.callFunction({\n\t\t\t\t\t\t\tname:'comment-create',\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t'topicId':this.item._id,\n\t\t\t\t\t\t\t\t'topicType':'post',\n\t\t\t\t\t\t\t\t'fromUser':{\n\t\t\t\t\t\t\t\t\t'userId':this.openId,\n\t\t\t\t\t\t\t\t\t'gender':this.gender,\n\t\t\t\t\t\t\t\t\t'avatarUrl':this.avatarUrl,\n\t\t\t\t\t\t\t\t\t'name':this.userName\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'content':this.textareaValue,\n\t\t\t\t\t\t\t\t'likeCount':[],\n\t\t\t\t\t\t\t\t'status':'ACTIVE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\t\tconsole.log('successfully created comment on post %s', JSON.stringify(res.result))\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tuniCloud.callFunction({\n\t\t\t\t\t\t\tname:'comment-create',\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t'topicId':this.commentId,\n\t\t\t\t\t\t\t\t'topicType':'comment',\n\t\t\t\t\t\t\t\t'fromUser':{\n\t\t\t\t\t\t\t\t\t'userId':this.openId,\n\t\t\t\t\t\t\t\t\t'gender':this.gender,\n\t\t\t\t\t\t\t\t\t'avatarUrl':this.avatarUrl,\n\t\t\t\t\t\t\t\t\t'name':this.userName\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'toUser':{\n\t\t\t\t\t\t\t\t\t'userId':this.openId,\n\t\t\t\t\t\t\t\t\t'gender':this.gender,\n\t\t\t\t\t\t\t\t\t'avatarUrl':this.avatarUrl,\n\t\t\t\t\t\t\t\t\t'name':this.userName\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'content':this.textareaValue,\n\t\t\t\t\t\t\t\t'likeCount':[],\n\t\t\t\t\t\t\t\t'status':'ACTIVE'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\t\tconsole.log('successfully created comment on post %s', JSON.stringify(res.result))\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t},\n\t\t\tsendCommentOnComment(e) {\n\t\t\t\tconsole.log(\"comment's id: %s\", JSON.stringify(e.target.id))\n\t\t\t\tthis.sendOnComment = true\n\t\t\t\tthis.commentId = e.target.id\n\t\t\t}\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\n"],"sourceRoot":""}